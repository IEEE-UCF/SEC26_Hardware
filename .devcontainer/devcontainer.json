{
	"name": "ROS 2 Jazzy & micro-ROS Dev",
	// Configure Dockerfile location and build arguments.
	"build": {
		"dockerfile": "../docker/dev_ws/Dockerfile", // Path updated as requested
		"context": "..",
	},
	// Set environment variables for the container. This is a cleaner way than setting them in the Dockerfile.
	"containerEnv": {
		"ARDUINO_DIRECTORIES_USER": "/home/rosdev/.arduino15",
	},
	// Set post startup behavior to do nothing
	"postStartCommand": "chmod +x scripts/install-dependencies.sh && scripts/install-dependencies.sh",
	// Set the user the container will run as.
	"remoteUser": "rosdev",
	// Arguments passed to 'docker run'.
	"runArgs": [
		"--privileged", // Required for accessing hardware devices like Teensy/ESP32.
		"--net=host",   // Use host networking for easier ROS 2 communication.
		"-v",
		"/dev:/dev" // Mount host's /dev directory to access serial ports.
	],
	// Configure VS Code settings>r and extensions.
	"customizations": {
		"vscode": {
			"settings": {
				// Set the default shell to bash to ensure .bashrc sourcing.
				"terminal.integrated.defaultProfile.linux": "bash",
				"terminal.integrated.profiles.linux": {
					"bash": {
						"path": "/bin/bash",
						"args": [
							"-l"
						]
					}
				},
				"python.defaultInterpreterPath": "/usr/bin/python3",
				// C/C++ extension settings moved from Dockerfile for better management.
				"C_Cpp.default.intelliSenseMode": "linux-gcc-x64",
				"C_Cpp.default.compilerPath": "/usr/bin/gcc",
				"C_Cpp.default.cStandard": "c17",
				"C_Cpp.default.cppStandard": "c++17",
				"C_Cpp.default.includePath": [
					"${workspaceFolder}/**",
					"/opt/ros/jazzy/include/**",
					"/home/rosdev/.arduino15/packages/**/cores/**",
					"/home/rosdev/.arduino15/packages/**/variants/**",
					"/home/rosdev/.arduino15/packages/**/libraries/**/src/**",
					"/home/rosdev/.arduino15/packages/**/tools/**/include/**"
				],
				"C_Cpp.default.defines": [],
				// ROS extension settings
				"ros.distro": "jazzy",
				// Arduino extension settings
				"arduino.useArduinoCli": true,
				"arduino.commandPath": "arduino-cli",
				"arduino.path": "/usr/local/bin",
				/*"arduino.additionalUrls": [
					"https://www.pjrc.com/teensy/package_teensy_index.json",
					"https://raw.githubusercontent.com/espressif/arduino-esp32/gh-pages/package_esp32_index.json"
				]*/
			},
			// A list of recommended extensions for this development environment.
			"extensions": [
				"ms-vscode.cpptools",
				"ms-python.python",
				"vsciot-vscode.vscode-arduino",
				"twxs.cmake",
				"redhat.vscode-yaml",
				"eamodio.gitlens",
				"ranch-hand-robotics.rde-pack",
				"davidanson.vscode-markdownlint",
				"me-dutour-mathieu.vscode-github-actions"
			]
		}
	},
  "workspaceFolder": "/home/rosdev/ros2_workspaces/${localWorkspaceFolderBasename}",
	"workspaceMount": "source=${localWorkspaceFolder},target=/home/rosdev/ros2_workspaces/${localWorkspaceFolderBasename},type=bind,consistency=cached"
}

